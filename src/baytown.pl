% Dynamic facts for relations,
% as they may not all exist in a XER.
:- dynamic(rel_fs/2).
:- dynamic(rel_sf/2).
:- dynamic(rel_ss/2).
:- dynamic(rel_ff/2).

% Activity relationships,
% Sorted by relationship type.
rel_fs(94101,94102).
rel_fs(94101,94167).
rel_fs(94102,94167).
rel_fs(94104,94099).
rel_fs(94104,94100).
rel_fs(94105,94104).
rel_fs(94106,94105).
rel_fs(94107,94106).
rel_fs(94108,94107).
rel_fs(94110,94111).
rel_fs(94111,94112).
rel_fs(94112,94113).
rel_fs(94113,94114).
rel_fs(94114,94115).
rel_fs(94115,94116).
rel_fs(94116,94117).
rel_fs(94117,94118).
rel_fs(94118,94193).
rel_fs(94118,94218).
rel_fs(94119,94131).
rel_fs(94120,94119).
rel_fs(94122,94121).
rel_fs(94123,94122).
rel_fs(94124,94123).
rel_fs(94126,94108).
rel_fs(94127,94100).
rel_fs(94127,94124).
rel_fs(94128,94125).
rel_fs(94128,94209).
rel_fs(94129,94128).
rel_fs(94129,94167).
rel_fs(94130,94209).
rel_fs(94132,94129).
rel_fs(94133,94135).
rel_fs(94134,94139).
rel_fs(94135,94136).
rel_fs(94135,94137).
rel_fs(94136,94139).
rel_fs(94137,94141).
rel_fs(94138,94141).
rel_fs(94139,94138).
rel_fs(94139,94148).
rel_fs(94140,94147).
rel_fs(94140,94173).
rel_fs(94140,94209).
rel_fs(94141,94142).
rel_fs(94141,94211).
rel_fs(94141,94218).
rel_fs(94143,94144).
rel_fs(94143,94150).
rel_fs(94144,94114).
rel_fs(94144,94145).
rel_fs(94144,94150).
rel_fs(94145,94146).
rel_fs(94146,94201).
rel_fs(94147,94209).
rel_fs(94148,94149).
rel_fs(94148,94201).
rel_fs(94149,94140).
rel_fs(94149,94146).
rel_fs(94150,94151).
rel_fs(94151,94153).
rel_fs(94151,94154).
rel_fs(94151,94158).
rel_fs(94153,94161).
rel_fs(94153,94182).
rel_fs(94155,94156).
rel_fs(94155,94157).
rel_fs(94156,94160).
rel_fs(94157,94163).
rel_fs(94159,94160).
rel_fs(94160,94166).
rel_fs(94160,94222).
rel_fs(94162,94155).
rel_fs(94163,94164).
rel_fs(94164,94165).
rel_fs(94165,94159).
rel_fs(94166,94169).
rel_fs(94167,94168).
rel_fs(94168,94169).
rel_fs(94169,94170).
rel_fs(94170,94171).
rel_fs(94171,94172).
rel_fs(94172,94173).
rel_fs(94173,94174).
rel_fs(94174,94175).
rel_fs(94175,94176).
rel_fs(94176,94177).
rel_fs(94177,94179).
rel_fs(94178,94180).
rel_fs(94178,94183).
rel_fs(94179,94178).
rel_fs(94180,94181).
rel_fs(94181,94185).
rel_fs(94182,94184).
rel_fs(94183,94184).
rel_fs(94184,94209).
rel_fs(94185,94186).
rel_fs(94186,94187).
rel_fs(94187,94188).
rel_fs(94188,94189).
rel_fs(94189,94190).
rel_fs(94190,94191).
rel_fs(94190,94192).
rel_fs(94190,94194).
rel_fs(94190,94195).
rel_fs(94190,94197).
rel_fs(94191,94193).
rel_fs(94191,94201).
rel_fs(94192,94196).
rel_fs(94193,94199).
rel_fs(94194,94146).
rel_fs(94194,94201).
rel_fs(94195,94198).
rel_fs(94196,94202).
rel_fs(94197,94198).
rel_fs(94198,94200).
rel_fs(94199,94200).
rel_fs(94200,94201).
rel_fs(94201,94125).
rel_fs(94201,94202).
rel_fs(94201,94210).
rel_fs(94202,94203).
rel_fs(94203,94205).
rel_fs(94204,94205).
rel_fs(94205,94206).
rel_fs(94206,94207).
rel_fs(94207,94208).
rel_fs(94209,94185).
rel_fs(94210,94202).
rel_fs(94212,94130).
rel_fs(94220,94134).
rel_fs(94223,94167).
rel_fs(94223,94222).
rel_ss(94142,94143).
rel_ss(94151,94152).
rel_ss(94152,94154).
rel_ss(94203,94204).
rel_ss(94384,94190).
rel_ss(94614,94178).

% Activity ID and Names
activity(94099,"02456541ZZ","REPLACE STEAM TRAP LPT-6 CONDENSER 31 LPSD").
activity(94100,"02389805ZZ","PERFORM HYDRO TEST ON MAIN STEAM TRAP STATION").
activity(94101,"60047200ZZ","REPAIR BROKEN SEAL TIGHT ON FT-926A LOOP 3 FLOW").
activity(94102,"60047201ZZ","RETEST FT-926A, SAFETY INJECTION LOOP 3 FLOW").
activity(94103,"60354002ZZ","REPLACE SWN-TCV-1113 VALVE,  STEAM PACKING LEAK").
activity(94104,"60772900ZZ","REPLACE VALVE 5EX-FCV-1210, LEAKS BY SEAT").
activity(94105,"60788902ZZ","RETEST FOR FCV-1210 VALVE SEAT LEAK").
activity(94106,"60788900ZZ","REPAIR INTERNAL LEAK FOR VALVE 5EX-FCV-1206").
activity(94107,"60788901ZZ","RETEST FCV-1206  VALVE FOR SEAT LEAK").
activity(94108,"60788903ZZ","INSPECT / REPAIR SUSPECTED LEAK BY ON VALVE").
activity(94109,"70071200ZZ","REPLACE DUST CAP ON SI-MOV-843 (MO)").
activity(94110,"70172304ZZ","PM 52/RCP31, TRIP CHECKS FOR BREAKERS").
activity(94111,"70172404ZZ","PM 52/RCP32, TRIP CHECKS FOR BREAKERS").
activity(94112,"70172604ZZ","PM 52/RCP33, TRIP CHECKS FOR BREAKERS").
activity(94113,"70174304ZZ","PM 52/RCP34, TRIP CHECKS FOR BREAKERS").
activity(94114,"70174804ZZ","PM 52/CP31, TRIP CHECKS FOR BREAKERS").
activity(94115,"70174904ZZ","PM 52/CP32, TRIP CHECKS FOR BREAKERS").
activity(94116,"70175004ZZ","PM 52/CP33, TRIP CHECKS FOR BREAKERS").
activity(94117,"70175204ZZ","PM 52/HDP31, TRIP CHECKS FOR BREAKERS").
activity(94118,"70175504ZZ","PM 52/HDP32, TRIP CHECKS FOR BREAKERS").
activity(94119,"70332400ZZ","PM FI-984, 31 RHR PUMP INDIVIDUAL RECIRCULATION").
activity(94120,"70332500ZZ","PM FI-985,  32 RHR PUMP INDIVIDUAL RECIRCULATION").
activity(94121,"70554100ZZ","PM 2HD-LCV-1138, 32A FWH TO 33 CONDENSER HI-HI").
activity(94122,"70554101ZZ","POST WORK TEST ON 2HD-LCV-1138,  STROKE AND ISLT").
activity(94123,"70565401ZZ","POST WORK TEST AFTER LCV-1124 (AO) CALIBRATION").
activity(94124,"70566300ZZ","PM LCV-1127C, HEATER DRAIN TANK BYPASS TO").
activity(94125,"70639802ZZ","PM ROD CLUSTER CONTROL - CONTROL ROD DRIVE").
activity(94126,"80049200ZZ","REPAIR LARGE INTERNAL LEAK FOR VALVE FCV-1159").
activity(94127,"80052700ZZ","REPAIR BODY TO BONNET LEAK FOR FCV-1204").
activity(94128,"80161700ZZ","ADJUST LIMIT SWITCH ON RC-AOV-549-33/O").
activity(94129,"80161701ZZ","POST WORK TEST 3PT-Q32 FOR RC-AOV-549-33/O").
activity(94130,"80162501ZZ","POST WORK TEST AFTER REPACK ON VALVE BFD-FCV-437").
activity(94131,"80189601ZZ","INSTALL GUAGE TO MONITOR BEARING #11 VACUUM").
activity(94132,"80216900ZZ","TROUBLESHOOT 31 RCP SP-2-1, HIGH VIBRATION ALARM").
activity(94133,"FO10005","DECREASE GENERATOR LOAD TO 100 MW").
activity(94134,"FO10006","AT APPROX 350 MW SHUT DOWN 31 HDP").
activity(94135,"FO10007","DECREASE GEN LOAD TO 40 MW; XFER HOUSE LOADS").
activity(94136,"FO10008","TRIP GENERATOR,  OFF THE GRID").
activity(94137,"FO10009","SECURE SECOND CONDENSATE PUMP").
activity(94138,"FO10010","REDUCE REACTOR POWER TO LESS THAN 4% - (MODE 2)").
activity(94139,"FO10011","BREAKER OPEN, START THE OUTAGE").
activity(94140,"FO10017","ESTABLISH H2 TO MAIN TURNINE GENERATOR").
activity(94141,"FO20001","SECURE FEEDWTR PUMPS; PLACE AUX FEED INSERVICE").
activity(94142,"FO20003","SHUTDOWN MAIN FEEDWATER PUMPS PER SOP-FW-1").
activity(94143,"FO20004","TRANSFER RCS TEMP CONTROL TO STEAM DUMPS").
activity(94144,"FO20005","CLOSE MAIN STEAM ISOLATION VALVES (MSIVS)").
activity(94145,"FO20006","SECURE CONDENSER AIR REMOVAL SYS, BREAK VACUUM").
activity(94146,"FO20006A","REMOVE TURBINE FROM TURNING GEAR").
activity(94147,"FO20006B","PLACE MAIN TURBINE ON GEAR AFTER OUTAGE WORK").
activity(94148,"FO20007","PLACE TURBINE GENERATOR ON TURNING GEAR PER").
activity(94149,"FO20010","REPLACE HYDROGEN WITH AIR PER SOP-TG-1").
activity(94150,"FO30001","INSERT CONTROL BANK RODS").
activity(94151,"FO30002","INSERT SHUTDOWN BANK RODS (MODE 3 ENTRY)").
activity(94152,"FO30003","ADJUST BORON CONCENTRATION TO HSD XENON FREE").
activity(94153,"FO30004","SHUTDOWN ROD DRIVE MG SETS AS PER SOP-RC-2").
activity(94154,"FO30005","BORATE TO COLD SHUT DOWN CONCENTRATION").
activity(94155,"FO30010","COOLDOWN RCS TO LESS THAN 350 DEGREES (MODE 4)").
activity(94156,"FO30011","ALIGN SAFETY INJECTION SYSTEM FOR OPERATION").
activity(94157,"FO30012","ESTABLISH N2 TO THE PORVS PER SOP-SI-1 (VIA 34)").
activity(94158,"FO30013","PERFORM INITIAL CONTAINMENT RADIATION SURVEY").
activity(94159,"FO30014","PLACE RHR IN SERVICE PER SOP-RHR-1").
activity(94160,"FO30015","COOLDOWN RCS TO LESS THAN 200 DEGREES (MODE 5)").
activity(94161,"FO40001","DEPRESSURIZE RCS TO APPROX 1700 PSI").
activity(94162,"FO40003","DEPRESSURIZE RCS TO 800 PSIG").
activity(94163,"FO40004","PLACE RCS OVER PROJECTION SYSTEM IN SERVICE").
activity(94164,"FO40005","DEPRESSURIZE RCS TO 350 PSIG").
activity(94165,"FO40006","WARM AND MIX RHR SYSTEM AND CHEMICAL SAMPLE").
activity(94166,"FO40007","COOLDOWN RCS TO 190 TO 180 DEGREES").
activity(94167,"FO49.4CSD","SIGNOFF BY MANAGERS FOR COLD SHUTDOWN  AP 9.4").
activity(94168,"FO50012","MANAGEMENT APPROVAL TO EXCEED COLD SHUTDOWN").
activity(94169,"FO50013","REMOVE RHR FROM SERVICE,  3PT-CS04").
activity(94170,"FO50014","RAISE RCS PRESSURE 400-1000").
activity(94171,"FO50015","HEATUP RCS TO 335-345 DEGREES").
activity(94172,"FO50016","PRESSURIZE SI ACCUMULATORS").
activity(94173,"FO50017","RCS TEMP GREATER THAN 350 DEGREES (MODE 3 ENTRY)").
activity(94174,"FO50018","HEATUP RCS TO 360-375 DEGREES").
activity(94175,"FO50019","RAISE RCS PRESSURE TO 1800 PSI").
activity(94176,"FO50020","HEATUP RCS TO 390-410 DEGREES").
activity(94177,"FO50021","HEATUP RCS TO 440-460 DEGREES").
activity(94178,"FO50022","RCS AT OPERATING TEMPERATURE").
activity(94179,"FO50023","VERIFY RCS ACTIVITY IN SPEC").
activity(94180,"FO50024","CLOSE-OUT CONTAINMENT PRIOR TO CRITICALITY").
activity(94181,"FO50025","PFM-49, SAT FOR CRITICALITY").
activity(94182,"FO50026","PLACE ROD CONTROL SYS IN SERVICE PER SOP-RC-1").
activity(94183,"FO50027","RCS AT OPERATING PRESSURE & TEMPERATURE").
activity(94184,"FO50028","CLOSE REACTOR PROTECTION SYSTEM TRIP BREAKERS").
activity(94185,"FO60001","EXIT POP-1.1 & ENTER POP-1.2, REACTOR START-UP").
activity(94186,"FO60002","ADJUST BORON FOR CRITICALITY PER POP-1.2").
activity(94187,"FO60003","WITHDRAW SHUTDOWN RODS PER POP-1.2").
activity(94188,"FO60004","WITHDRAW CONTROL BANK RODS PER POP-1.2").
activity(94189,"FO60005","VERIFY RCS CHEMISTRY IS IN SPEC PER RCS-6").
activity(94190,"FO60006","RX CRITICAL (MODE 2 ENTRY) EXIT POP-1.2").
activity(94191,"FO60007","OPEN MAIN STEAM ISOLATION VALVES").
activity(94192,"FO60008","VERIFY RCS CHEMISTRY IN SPEC PER SOP-RCS-6").
activity(94193,"FO60009","DRAW VACUUM IN MAIN CONDENSER USING MAIN STEAM").
activity(94194,"FO60010","HEAT UP MAIN TURBINE GENERATOR").
activity(94195,"FO60011","HOLD FOR CHEMISTRY AT 0-2% POWER").
activity(94196,"FO60012","VERIFY STEAM GENERATOR CHEMISTRY IS IN SPEC").
activity(94197,"FO60013","INCREASE REACTOR POWER TO 2-5% (MODE 1 ENTRY)").
activity(94198,"FO60014","INCREASE REACTOR POWER TO 5-10%").
activity(94199,"FO60015","BRING CONDENSATE OXYGEN INTO SPEC FOR MAIN").
activity(94200,"FO60016","SWAP FROM AUX FEEDWATER TO MAIN FEEDWATER").
activity(94201,"FO60017","ROLL THE TURBINE GENERATOR").
activity(94202,"FO60019","SYNC TURBINE TO THE GRID / BREAKER CLOSED").
activity(94203,"FO60020","RAISE RX POWER FROM 15% TO 20%").
activity(94204,"FO60021","SWAP FEEDWATER FROM MANUAL TO AUTOMATIC").
activity(94205,"FO60023","RAISE RX POWER FROM 25% TO 30%").
activity(94206,"FO60024","PERFORM SOP-RPC-6, REACTOR THERMAL PWR CALC").
activity(94207,"FO60025","INCREASE RX POWER FROM 30% TO 100%").
activity(94208,"FO60026","UNIT AT 100% POWER").
activity(94209,"FO69.4CRIT","SIGNOFF BY MANAGERS FOR RX CRITICAL AP 9.4").
activity(94210,"FO69.4SYNC","SIGNOFF BY MANAGERS FOR SYNC TO GRID AP 9.4").
activity(94211,"OPS980003H","HANG SAFETY TAG (PTO'S) FOR FEED REG VALVE").
activity(94212,"OPS980003R","REMOVE SAFETY TAG (PTO'S) FOR FEED REG VALVE").
activity(94213,"OPS980010H","HANG SAFETY TAG (PTO) FOR CH-MOV-250B WORK").
activity(94214,"OPS980010R","REMOVE SAFETY TAG (PTO) FOR CH-MOV-250B").
activity(94215,"OPS980011H","HANG SAFETY TAG (PTO) FOR CH-MOV-250D (BLUE)").
activity(94216,"OPS980017H","HANG SAFETY TAG (PTO) FOR BIT HEADER").
activity(94217,"OPS980017R","REMOVE SAFETY TAG (PTO) FOR BIT HEADER").
activity(94218,"OPS980027H","HANG SAFETY TAG (PTO) FOR MBFP MAIN OIL PUMP").
activity(94219,"OPS980027R","REMOVE SAFETY TAG (PTO) FOR #31  MBFP  MAIN OIL").
activity(94220,"OPS980029H","HANG SAFETY TAG (PTO) FOR CH-107").
activity(94221,"OPS980029R","REMOVE SAFETY TAG (PTO) FOR CH-107").
activity(94222,"OPS980031H","HANG SAFETY TAG (PTO) FOR 33 INVERTER WORK").
activity(94223,"OPS980031R","REMOVE SAFETY TAG (PTO) FOR 33 INVERTER WORK").
activity(94224,"OPS980032H","HANG SAFETY TAG (PTO) FOR 31 ACCUMULATOR CALS").
activity(94225,"OPS980032R","REMOVE SAFETY TAG (PTO) AFTER 31 ACCUMULATOR").
activity(94226,"OPS980033H","HANG SAFETY TAG (PTO) FOR 32 ACCUMULATOR CALS").
activity(94227,"OPS980033R","REMOVE SAFETY TAG (PTO) AFTER 32 ACCUMULATOR").
activity(94228,"OPS980034H","HANG SAFETY TAG (PTO) FOR 33 ACCUMULATOR CALS").
activity(94229,"OPS980034R","REMOVE SAFETY TAG (PTO) AFTER 33 ACCUMULATOR").
activity(94230,"OPS980011R","REMOVE SAFETY TAG (PTO) FOR MOV-250").
activity(94384,"FO60026","UNIT AT 100% POWER").
activity(94614,"FO60026","UNIT AT 100% POWER").

write_activity_name(Activity) :-
    activity(Activity,Activity_ID,Activity_Name),
    format('~w ~w ~w ~n',[Activity,Activity_ID,Activity_Name]).

write_activity_list(Activity_List) :-
    maplist(write_activity_name, Activity_List).

named_path(Start,Finish,Path) :-
    raw_path(Start,Finish,Path),
    maplist(write_activity_name, Path).

raw_path(Start,Finish,Path) :-
    travel(Start,Finish,[Start],Q), 
    reverse(Q,Path).

travel(Start,Finish,P,[Finish|P]) :- 
    move(Start,Finish).

travel(Start,Finish,Visited,Path) :-
    move(Start,C),           
    C \== Finish,
    \+member(C,Visited),
    travel(C,Finish,[C|Visited],Path). 

move(X,Y) :- to_start(X,Y).

% To start Y, need X
to_start(X,Y) :- rel_fs(X,Y) ; rel_ss(X,Y).

% To finish Y, need X
to_finish(X,Y) :- rel_ff(X,Y) ; rel_sf(X,Y).

